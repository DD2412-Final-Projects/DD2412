import matplotlib as mpl
import matplotlib.pyplot as plt


if __name__ == "__main__":

    SGD_max_conf = [0.6929448246955872, 0.9280307292938232, 0.9870281219482422, 0.9980050921440125, 0.999650239944458, 0.9999263286590576, 0.9999830722808838, 0.9999967813491821, 0.9999995231628418, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
    SGD_conf_acc_diff = [0.09352778682112689, 0.34211973416805264, 0.44456084597110745, 0.35816633880138393, 0.2610643504858017, 0.16982233214378362, 0.12396196985244756, 0.10199134421348566, 0.10199856877326963, 0.07999979591369621, 0.01200000000000001, 0.018000000000000016, 0.02200000000000002, 0.020000000000000018, 0.020000000000000018, 0.016000000000000014, 0.020000000000000018, 0.02400000000000002, 0.02400000000000002, 0.02200000000000002]

    SWA_max_conf = [0.5845911502838135, 0.7829484343528748, 0.9004436731338501, 0.9583830237388611, 0.9827173352241516, 0.9930150508880615, 0.9969505071640015, 0.9987550973892212, 0.9994449019432068, 0.9997358918190002, 0.9998769760131836, 0.9999493360519409, 0.9999805688858032, 0.9999938011169434, 0.9999980926513672, 0.9999995231628418, 0.9999998807907104, 1.0, 1.0, 1.0]
    SWA_conf_acc_diff = [0.10476908105611804, 0.22500673878192895, 0.36221274542808535, 0.3456755028963089, 0.3247349034547805, 0.2625982269048691, 0.23124248254299162, 0.15400155448913577, 0.12515462195873261, 0.0776065347194671, 0.06381490397453304, 0.05391946625709543, 0.04796681356430055, 0.033988089799880994, 0.019996296644210876, 0.011998968839645352, 0.019999774932861314, 0.003999991416931192, 0.0, 0.006000000000000005]

    SWAG_diag_max_conf = [0.4813584996222138, 0.5712615119951806, 0.6591570562372605, 0.7412775005524357, 0.8136785783804953, 0.8739567344387372, 0.9194061011075974, 0.9471012443304062, 0.9611544489860534, 0.9701497932275136, 0.9777711649735769, 0.9828698108593623, 0.9832984189192454, 0.9883245329062144, 0.9978604257106781, 0.9995117346445719, 0.9998553733030955, 0.9999555508295694, 0.9999907453854878, 1.0]
    SWAG_diag_conf_acc_diff = [0.01556788576303303, 0.047547341837688495, 0.027601733289180364, 0.023151124580223503, 0.05760694958997503, 0.03332886993234452, 0.024029459878931902, -0.0037052574328551025, 0.009534424075655079, 0.0039630143406340634, 0.013542636457085644, 0.004986005781094316, -0.012834157804648139, 0.0020143740991751535, 0.03453032037019721, 0.014890408337116301, 0.0037182378689447626, 0.007916744581858315, -2.3460829258081795e-05, -3.445255756351351e-06]

    SWAG_max_conf = [0.48117255019412064, 0.5685655050839462, 0.6486493799175757, 0.7348785813121745, 0.812307823979063, 0.8722210857610965, 0.9150348167866468, 0.9433222462733587, 0.9606935669978459, 0.9671131233374277, 0.977693971991539, 0.9826227635145187, 0.983273857831955, 0.9840143084526062, 0.9969950556755066, 0.9993589798609416, 0.9998219589392344, 0.9999474624792735, 0.999988607565562, 1.0]
    SWAG_conf_acc_diff = [0.026150421898688547, 0.025658808770204655, -0.004005556208492189, 0.0329866664641536, 0.030270178266511016, 0.027960292323221947, 0.013936508128165048, 0.017768838286263966, 0.0071060909792936, -0.003444079622218821, 0.015908963892857342, 0.004111863780021596, -0.014937195084492538, -0.014667849401633015, 0.028014117324352328, 0.010525854194164186, 0.011638032277425103, 0.005895690409342458, 0.0019715738972027053, -4.034233093253015e-06]

    ax = plt.axes()

    ax.axhline(linestyle="--", color="b", label="Ideal")  # ideal
    ax.plot(SGD_max_conf, SGD_conf_acc_diff, "-o", color="r", label="SGD")  # SGD
    ax.plot(SWA_max_conf, SWA_conf_acc_diff, "-o", color="g", label="SWA")  # SWA
    ax.plot(SWAG_diag_max_conf, SWAG_diag_conf_acc_diff, "-o", color="y", label="SWAG-Diag")  # SWAG-Diag
    ax.plot(SWAG_max_conf, SWAG_conf_acc_diff, "-o", color="m", label="SWAG")  # SWAG

    plt.title("Reliability diagram")
    plt.xlabel("Confidence (max in bin)")
    plt.ylabel("Confidence - Accuracy (mean in bin)")
    plt.xscale('logit')
    plt.xlim(0.01, 0.9999999)
    ax.xaxis.set_minor_formatter(mpl.ticker.FormatStrFormatter(""))
    ax.tick_params(axis='both', which='major', labelsize=8)
    ax.tick_params(axis='both', which='minor', labelsize=6)

    # Shrink current axis's height by 10% on the bottom
    box = ax.get_position()
    ax.set_position([box.x0, box.y0 + box.height * 0.15,
                     box.width, box.height * 0.85])

    # Put a legend below current axis
    ax.legend(loc='upper center', bbox_to_anchor=(0.5, -0.15),
              fancybox=True, shadow=True, ncol=5)
    plt.grid()
    plt.show()
